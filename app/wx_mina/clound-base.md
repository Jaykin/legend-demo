# 云开发

## 1、概述
一种`新的开发模式`，开发者可以使用云开发开发微信小程序、小游戏，其`弱化了后端和运维概念`，无需搭建服务器，使用`平台提供的 API 进行核心业务开发`，即可实现快速上线和迭代

### 1.1 Hello World
* `新建云开发模板`：即小程序代码
* `开通云开发、创建环境`：即保证能提供云开发能力
* `查看云开发控制台`：用来管理云开发资源

### 1.2 云开发能力
>即云开发提供的基础能力    
#### 1.2.1 云函数
>在云端运行的代码。无需自建服务器
* 在开发工具内编写、一键上传部署即可运行的后端代码

#### 1.2.2 数据库
>一个既可在小程序前端操作，也能在云函数中读写的 `JSON 数据库`。无需自建数据库。   
* 数据库 API 分为小程序端和服务端
* 使用 API
  * 获取数据库引用
  * 构造查询/更新条件
  * 发出请求

#### 1.2.3 存储
>在小程序前端直接上传/下载云端文件，在云开发控制台可视化管理。无需自建存储和 CDN。
* 可以在小程序端和云函数端通过 API 使用云存储功能

#### 1.2.4 云调用
>基于云函数使用小程序开放接口的能力，即可在服务端使用原生微信服务

#### 1.2.5 HTTP API
>云开发资源(即云函数/数据库/存储)也可以通过 HTTP 接口访问

### 1.3 相关概念
* `资源环境`
  * 一个环境对应一整套独立的云开发资源，各个环境相互独立，每个环境都有`环境 ID` 来标识
  * 开通云开发后即创建了一个环境，默认可拥有最多两个环境（一般为 `test 测试环境`、`release 正式环境`）
* `配额`
  * 即云开发各类资源的分配方案，不同的服务有其最佳的配额指标，不同的配额有不同的价格
  * 分类
    * 资源均衡型
    * CDN 资源消耗型
    * 云函数资源消耗型
    * 数据库资源消耗型
* 技术概念
  * 并发(Concurrent): 指两个或多个事件在同一时间间隔内发生(单 CPU)
  * 并行(Parallel): 是指两个或者多个事件在同一时刻发生(多 CPU)

## 2、指南

### 2.1 初始化
#### 2.1.1 小程序初始化
```javascript
wx.cloud.init({
    env: 'envId',   // 指定 API 调用的环境
    traceUser: true
})
```

#### 2.1.2 云函数初始化
```javascript
const cloud = require('wx-server-sdk')
cloud.init({
    env: cloud.DYNAMIC_CURRENT_ENV  // 指定本次云函数 API 调用的环境
})
```

### 2.2 调试
* 云函数本地调试
* Network 面板：支持显示云开发请求

### 2.3 数据库
>提供的是 JSON 数据库，注意区别于关系型数据库   

| 关系型 | 文档型 |
| --- | --- |
| 数据库 database | 数据库 database |
| 表 table | 集合 collection |
| 行 row | 记录 record/doc |
| 列 column | 字段 field |

* 创建集合
* 基础概念
  * 数据类型
  * 权限管理
  * 索引
* 增删查改
* 

### 2.4 存储

### 2.5 云函数

### 2.6 云调用

## 3、API

## 4、参考