<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>09_store</title>
    <script src="https://unpkg.com/vue/dist/vue.js"></script>
</head>
<body>
    <div id="app">
        <jay-store-a></jay-store-a>
        <jay-store-b></jay-store-b>
    </div>

    <script>
        // 1、自定义全局实例属性（非响应式）
        Vue.prototype.$jayStore = {
            name: 'Jay',
            age: 18
        };

        // 2、mixin data（非响应式）
        Vue.mixin({
            data: function () {
                return {
                    'jayMixinData': {
                        name: 'Jay',
                        age: 18
                    }
                }
            }
        });

        // 3、Vue.observable()（响应式）
        const state = Vue.observable({
            name: 'Jay',
            age: 18
        });

        // 4、简单 store（自定义共享范围）
        const store = {
            state: {
                name: 'Jay',
                age: 18
            },

            setNameAction(newVal) {
                this.state.name = newVal;
            },

            setAgeAction(newVal) {
                console.log('store.setAgeAction: ', this.state.age, newVal);
                this.state.age = newVal;
            }
        };
    </script>

    <script>
        Vue.component('JayStoreA', {
            template: `<div @click="click">jay-store-a {{ stateShared.name }} {{ sharedState.age }}</div>`,
            data() {
                return {
                    sharedState: store.state
                }
            },
            computed: {
                stateShared: function () {
                    return state;
                }
            },
            mounted() {
                console.log('$jayStore: ', this.$jayStore);
                this.$jayStore.name = 'Vivian';
                
                console.log('jayMixinData: ', this.jayMixinData);
                this.jayMixinData.name = 'Vivian'

                console.log('stateShared: ', this.stateShared);
            },

            methods: {
                click() {
                    this.stateShared.name = 'Vivian';
                    store.setAgeAction(22);
                }
            }
        });

        Vue.component('JayStoreB', {
            template: `<div>jay-store-b {{ stateShared.name }} {{ sharedState.age }}</div>`,
            data() {
                return {
                    sharedState: store.state
                }
            },
            computed: {
                stateShared: function () {
                    return state;
                }
            },
            mounted() {
                console.log('$jayStore: ', this.$jayStore);
                console.log('jayMixinData: ', this.jayMixinData);
                console.log('stateShared: ', this.stateShared);
            }
        });
    </script>

    <script>
        const app = new Vue({
            el: '#app'
        });
    </script>
</body>
</html>