<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body style="margin: 0">

    输入小球移动后的位置：<input type="text" id="pos"/>
    <button id="moveBtn">开始移动</button>
    <button id="cancelBtn">撤销</button> <!--增加取消按钮-->
    <div style="position: relative;">
        <div id="ball" style="position:absolute;background:#000;width:50px;height:50px"></div>
    </div>

    <script src="../02-strategy/02-animate.js"></script>
    <script>
        //
        var ball = document.getElementById('ball');
        var tarPos = document.getElementById('pos');
        var startMoveBtn = document.getElementById('moveBtn');
        var cancelMoveBtn = document.getElementById('cancelBtn');
        var animate, moveCommand;


        /**
         * @function moveCommand - 创建命令
         * @param {object} - 接收命令方
         * */
        function createMoveCommand(receiver) {
            var oldPos;
            var args = null;
            var temp;

            return {
                execute: function () {
                    receiver.start.apply(receiver, arguments);
                    args = arguments;
                    oldPos = receiver.startPos;
                },

                undo: function () {
                    if (args) {
                        temp = args[1];
                        args[1] = oldPos;
                        oldPos = temp;

                        receiver.start.apply(receiver, args);
                        args = null;
                    }
                }
            }
        }

        // 接收方
        animate = new Animate(ball);
        // 命令对象
        moveCommand = createMoveCommand(animate);

        // 请求方
        startMoveBtn.onclick = function () {
            moveCommand.execute('left', tarPos.value, 5000, 'linear');
        }

        cancelMoveBtn.onclick = function () {
            moveCommand.undo();
        }


    </script>
</body>
</html>